#Vim编辑器学习笔记

[TOC]
December 5, 2017 10:52 PM
_ _ _
#### 1.vi的三种模式
- 一般指令模式
用vi打开一个文件的时候默认在一般指令模式下，这个时候可以使用“上下左右”按键来移动鼠标，也可以通过”复制、粘贴、移动“等等来进行文档处理。**注意：这个时候不能够进行键入操作**。
- 编辑模式
当按下“i, I, o, O, a, A, r, R”等任何一个字母之后进入编辑模式，这个时候在左下角出现“插入”或者“替换”字样，那么就可以进行编辑了。
如果要退回到一般指令模式，那么按下“ESC”按键就可以退出编辑模式。
- 命令行命令模式
在一般模式中，输入“ : / ? ”三个中的任何一个按钮，就可以将光标移到最下面那一列，这个时候可以进行键入命令操作。
如果要退回到一般指令模式，那么按下“ESC”按键。

**注意**：编辑模式和命令行命令模式只能由一般指令模式进行切换，两者不能够直接切换。

#### 2.vi [filename]
使用该命令打开filename文件，进入一般指令模式。
- i, I, o, O, a, A, r, R进入编辑模式
按下上述的字符，进入编辑模式，开始编辑文字。进入编辑模式后，左下角会出现--插入--字样，表示可以开始编辑文字。如果要退出该模式到一般输入模式，那么按下ESC按键即可（按下ESC按键后左下角的--插入--会消失）。
-  : / ?进入命令行界面（光标会移动到最下面一行）
 * `:wq`：输入`:wq`命令就可以存盘离开。
 * `:w`：写入操作。
 * `:q`：退出操作。
 * `!`：在上述命令后加入`!`就是强制。比如，`:wq!`就是强制写入并退出。

#### 3.一般指令模式下的按键
- 光标移动
|    移动光标    |    作用   |
|:-------------:|:---------:|
|h或向左方向键    |光标向左移动一个字符|
|j或向下方向键    |光标向下移动一个字符|
|k或向上方向键    |光标向上移动一个字符|
|l或向右方向键    |光标向右移动一个字符|
|使用n+方向键连续移动n次，例如“30j”就是向下移动30列| |
|[Ctrl]+[f]     |屏幕向下移动一页   |
|[Ctrl]+[b]     |屏幕向上移动一页   |
|[Ctrl]+[d]     |屏幕向下移动半页   |
|[Ctrl]+[u]     |屏幕向上移动半页   |
|+              |光标移动到非空白字符的下一列|
|-              |光标移动到非空白字符的上一列|
|n<space>       |光标会往后移动n个字符  |
|home键       |移动到这一行的最前面的字符处|
|$或End键        |移动到这一行最后的字符处|
|H              |光标移动到这个屏幕的最上方那一行的第一个字符(Head)|
|M              |光标移动到这个屏幕的中央那一行的第一个字符(Medium)|
|L              |光标移动到这个屏幕的最下方那一行的第一个字符(Low)|
|G              |移动到这个文件的最后一行     |
|nG             |移动到这一个文件的第n行的第一个字符|
|gg             |移动到这个文件的第一行，相当于1G|
|n<Enter>       |n为数字，光标向下移动n行   |

- 搜寻与取代部分
|    搜寻与取代    |             |
|:---------------:|:-----------:|
|/word           |从光标向下寻找名称为word的字串|
|?word           |从光标向上寻找一个字串名称为word的字串|
|n               |这个n为英文按键，表示重复前一个搜寻动作|
|N               |N为英文按键，表示反向进行前一个搜索动作|
|:n1,n2s/word1/word2/g |n1与n2为数字。在第n1与n2列之间寻找word1这个字串，并将该字串取代为word2。如果n2为$，那么表示从n1行开始到最后一行。如果g改为gc，那么每次替换的时候都会显示确认是否替换。|

- 删除、复制与粘贴
|         操作      |           |
|:-----------------:|:---------:|
|x,X              |x为向后删除一个字符，X为向前删除一个字符|
|nx           |n为数字，连续向后删除n个字符|
|dd           |删除光标所在的那一整行     |
|ndd          |删除光标所在的向下n行（包括光标那一列）     |
|d1G       |删除光标所在到第一行的所有数据|
|dG        |删除光标所在到最后一行的所有数据 |
|d$        |删除光标所在处，到该行最后一个字符|
|d0        |删除光标所在处，到该行的最前面的字符|
|yy        |复制光标所在的那一行       |
|nyy       |n为数字，复制光标所在的向下n行|
|y1G       |复制光标所在列到第一列的所有数据|
|yG        |复制光标所在列到最后一列的所有数据|
|y0        |复制光标所在的字符到那一行第一个字符的所有数据|
|y$        |复制光标所在的字符到那一行最后一个字符的所有数据|
|p，P      |p为将已复制的数据在光标下一列贴上，P则为贴在光标上一列|
|J         |将光标所在列与下一列的数据结合成同一列 |
|c         |重复删除多个数据      |
|u         |复原前一个动作       |
|[Ctrl]+r  |重做上一个动作       |

* 一般指令模式切换到编辑模式的可用按钮说明
|       按键      |     |
|:---------------:|:--------:|
|i,I           |进入插入模式，i为“从目前光标处插入”，I为“从目前所在行的第一个非空白字符处插入”|
|a,A           |进入插入模式，a为“从光标所在下一个字符处开始插入”，A为“从目前光标所在行最后一个字符处开始插入”。|
|o,O           |进入插入模式，o为“在目标光标所在的下一列插入新的一列”，O为在光标所在行的上一行插入新的一行|
|r,R           |进入取代模式，r只会取代光标所在字符一次，R会一直取代光标所在字符，直到按下ESC为止|
|ESC           |退出编辑模式|

* 一般指令模式切换到命令行界面的可用按钮说明
|    命令行界面的储存，离开等指令  |     |
|:----------------------------:|:----:|
|:w                 |将编辑的数据写入磁盘文件|
|:w!                |强制写入（与文件权限有关）|
|:q              |离开vi
|:q!             |强制离开，如果更改过文件又不想保存，直接强制了离开|
|:wq             |储存文件后离开    |
|ZZ               |若文件没有改动，则不储存离开，若文件有改动，则储存后离开|
|:w [filename]     |将编辑的数据储存成另一个文件|
|:r [filename]      |在编辑的数据中，读入另一个文件的数据，即将filename文件的内容加到光标所在行后面|
|:n1,n2 w [filename]   |将n1到n2行的内容储存成filename这个文件|
|:! command         |暂时离开vi到命令行界面执行command显示结果。|
|:set nu  |vim环境变更，显示行号|
|:set nonu |与set nu相反，为取消行号|

#### 3.Vim的暂存盘、救援恢复和打开时的警告讯息
- **暂存盘**
当在使用vim进行编辑filename文件时，vim会在被编辑的文件的目录下，再创建一个名称为.filename.swp的文件，在编辑时，vim会主动地将编辑动作记录在该文件中，因此，如果电脑突然死机导致文件编辑中断，**.swp文件无法借正常流程结束，所以就不会消失**，之后可以通过.swp文件进行回复。
- **救援回复**
当再次打开这个filename文件时，由于系统检测到相应.swp文件的存在，会判断这个文件可能有问题。那么就会提出两种主要问题以及解决方案：
 * 问题一：可能有其他人也在编辑这个文件
 解决方法：1. 找到那个程序员，让他结束该文件的编辑工作；2. 如果只是打开文件查看内容而不进行修改，那么可以选择打开成只读文件，即输入英文“o”即可。
 * 问题二：之前编辑文件时，某种不知名原因导致vim中断
 解决办法：1.如果之前的vim处理尚未保存，那么按下“R”，即Recover，vim会载入相应.swp内容。**注意这个操作不会删除这个.swp文件，需要手动进行删除**。2.如果确定这个暂存盘确实无用，那么直接按下“D”来删除。

#### 4.区块选择
|  区块选择的按键意义  |            |
|:-----------------:|:-----------:|
|v          |字符选择，会将光标经过的地方反白选择|
|V          |行选择，会将光标经过的行反白选择|
|[Ctrl]+v   |区块选择，可以用长方形的方式选择数据|
|y         |将反白的地方复制起来|
|d         |将反白的地方删除掉|
|p         |将刚刚复制的区块，在光标所在处贴上|

#### 5.多文件编辑
|  多文件编辑的按键  |     |
|:---------------:|:----:|
|:n      |编辑下一个文件   |
|:N      |编辑上一个文件   |
|:files  |列出目前这个vim打开的所有文件|

#### 6.多窗口编辑功能
**适用情况**：一个文件非常大，需要前后对照着看，不方便适用pageup和pagedown来前后查阅；有两个文件需要对照着看。
使用以下代码：
`:sp filename`
如果后面不接filename，那么默认是当前文件再打开一次。
**按键操作**：

|   多窗口情况下按键操作功能|     |
|:--------------------:|:-----:|
|:sp [filename]   |打开一个文件同窗口显示|
|[Ctrl]+w+j     |按键的按法是：先按下[ctrl]不放，再按下w后放开所有的按键，然后再按下j（或向下方向键），则光标可移动到下方的窗口。|
|[Ctrl]+w+k     |方法同上，只是光标移动到上一个窗口|
|[Ctrl]+w+q     |结束离开，将光标移动到需要离开的窗口，按下键即可|

#### 7.vim的挑字补全功能
|   组合按钮    |    补齐内容    |
|:------------:|:-------------:|
|[ctrl]+x -> [ctrl]+n | 通过目前正在编辑的这个“文件的内容文字”作为关键字予以补齐|
|[ctrl]+x -> [ctrl]+f |以当前目录内的“文件名”作为关键字，予以补齐  |
|[ctrl]+x -> [ctrl]+o |以扩展名作为语法补充，以vim内置的关键字，予以补齐|
**注意**：第三种补齐方法要注意文件的扩展名，vim会根据扩展名来显示待选词。

#### 8.vim环境设置与记录：~/.vimrc,~/.viminfo
| vim的环境设置参数  |     |
|:----------:|:--------------------:|
|:set nu  :set nonu              |   设置和取消行号|
|:set hlsearch  :set nohlsearch  |high light search(高亮度搜寻)|
|:set autoindent  :set noautoindent|是否自动缩排 |
|:set backup    |是否自动储存备份文件，一般是nobackup，如果设置backup，那么会产生一个filename~的文件  |
|:set ruler    |是否显示右下角的状态说明值|
|:set showmode  |是否显示左下角的--插入--等字眼 |
|:set backspace=(012)  |等于2时，可以删除任意字符，等于0或1时，仅可删除刚刚输入的字符 |
|:set all  |显示目前所有的环境参数设置值 |
|:set     |显示与系统默认值不同的设置参数 |
|:syntax on  :syntax off  |是否依据语法显示不同的颜色  |
|:set bg=dark  :set bg=light  |显示不同的颜色色调 |

还可以使用配置文件进行设置各个参数：
不建议修改原文件，创建一个 **~/.vimrc** 文件，手动创建。